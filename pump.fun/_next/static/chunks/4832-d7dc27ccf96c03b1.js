(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4832],{46601:function(){},19198:function(e,t,a){"use strict";a.d(t,{J:function(){return g}});var s=a(57437),n=a(37440),r=a(29113),i=a(54891),l=a(4867),o=a(4815),c=a(28782),d=a(43061),u=a(44839),f=a(2265),h=a(27485),p=a(6299),m=a(90837),x=a(83102);let g=e=>{let{fetchUser:t}=e,a=(0,d.O_)(),[g,v]=(0,o._)("prompt-shown",!1),[b,w]=(0,f.useState)(!1),{user:y,fetchUser:j}=(0,i.U)(),{publicKey:N}=(0,c.O)(),{ipfsPrefix:k}=(0,r.y)(),[S,E]=(0,f.useState)(),[T,_]=(0,f.useState)(),[C,P]=(0,f.useState)(),[I,O]=(0,f.useState)(null),[A,B]=(0,f.useState)(!1),U=(0,f.useRef)(null),[z,D]=(0,f.useState)(!1),[L,R]=(0,f.useState)(!1),[V,F]=(0,f.useState)(!1),[M,G]=(0,f.useState)();(0,f.useEffect)(()=>{a&&!g&&(w(!0),v(!0))},[a]),(0,f.useEffect)(()=>{let e=(0,n.Py)(null==y?void 0:y.profile_image,k);console.log("clean",e),z||_((null==y?void 0:y.username)||(null==N?void 0:N.toBase58().slice(0,6))),A||P(e),L||E((null==y?void 0:y.bio)||"")},[y,N]);let X=async()=>{let e;if(F(!0),G(void 0),I){let t=new FormData;t.append("file",I);let a=await fetch("/api/ipfs-file",{method:"POST",body:t});e=await a.json().then(e=>e.fileUri)}let a=await fetch("".concat("https://frontend-api.pump.fun","/users"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileImage:e,username:T,bio:S})}).then(e=>{if(!e.ok)throw Error(e.statusText);return e.json()}).catch(e=>(G(e.message),{}));a.error&&G(a.error),D(!1),B(!1),O(null),R(!1),t?t():j(),F(!1)};return(0,s.jsxs)(m.Vq,{open:b,onOpenChange:e=>{w(e)},children:[(0,s.jsx)(m.hg,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex gap-2 items-center border border-slate-500 rounded px-1 cursor-pointer hover:bg-slate-700",children:["Edit profile ",(0,s.jsx)(l.oqE,{})]})}),(0,s.jsx)(m.cZ,{className:"bg-primary text-white",children:(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)("div",{className:"font-bold",children:"Edit profile"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("div",{children:"Profile photo"}),(0,s.jsxs)("div",{className:"relative cursor-pointer",onClick:()=>{U.current&&U.current.click(),B(!0)},children:[(0,s.jsx)(p.default,{src:C,alt:"",width:64,height:64,className:"w-16 h-16 rounded-full border border-slate-500 object-contain"}),(0,s.jsx)(l.oqE,{className:"absolute right-[-6px] bottom-[-6px] h-6 w-6"}),(0,s.jsx)("input",{type:"file",ref:U,onChange:e=>{let t=e.target.files[0];t&&(P(URL.createObjectURL(t)),O(t))},style:{display:"none"},accept:"image/*"})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,s.jsx)("div",{children:"Username"}),(0,s.jsx)(x.I,{className:"bg-transparent text-white outline-none w-full pl-3",value:T,onChange:e=>{_(e.target.value),D(!0)}})]}),(0,s.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,s.jsx)("div",{children:"Bio"}),(0,s.jsx)(x.I,{className:"bg-transparent text-white outline-none w-full pl-3",value:S,maxLength:250,onChange:e=>{E(e.target.value),R(!0)}})]}),!(null==y?void 0:y.username)&&(0,s.jsx)("div",{className:"text-xs text-orange-400 justify-self-end",children:"You can change your username once every day"}),M&&(0,s.jsx)("div",{className:"text-xs text-red-400 justify-self-end",children:M}),(0,s.jsxs)("div",{className:"flex gap-2 w-fit justify-self-end",children:[(0,s.jsx)("div",{className:"text-slate-50 hover:font-bold hover:text-slate-50 cursor-pointer w-fit justify-self-center",onClick:()=>w(!1),children:"[close]"}),(0,s.jsx)("button",{onClick:()=>X(),disabled:V||!z&&!A&&!L,className:(0,u.Z)("py-1 px-4 rounded cursor-pointer",z||A||L?"bg-green-600 text-white":"bg-slate-400 text-black"),children:V?(0,s.jsx)(h.iT,{color:"white",height:24,width:24}):"Save"})]})]})})]})}},6299:function(e,t,a){"use strict";a.d(t,{default:function(){return l}});var s=a(57437),n=a(66648),r=a(2265);let i=e=>{let{width:t=100,height:a=100,color:n="#666",background:r="#ccc",fontSize:i="20",text:l,className:o}=e,c=l||"".concat(t,"x").concat(a),d=encodeURIComponent('\n    <svg width="'.concat(t,'" height="').concat(a,'" xmlns="http://www.w3.org/2000/svg">\n      <rect width="100%" height="100%" fill="').concat(r,'" stroke="').concat(n,'" />\n      <text x="50%" y="50%" dominant-baseline="middle" font-family="-apple-system, Inter, sans-serif" text-anchor="middle" fill="').concat(n,'" font-size="').concat(i,'" font-size-adjust="0.58" >\n        ').concat(c,"\n      </text>\n\n    </svg>\n\n"));return(0,s.jsx)("img",{className:o,src:"data:image/svg+xml;charset=UTF-8,".concat(d),alt:"".concat(t,"x").concat(a," placeholder")})};var l=e=>{let[t,a]=(0,r.useState)(!1),l="".concat(e.src,"?img-width=").concat(e.width,"&img-dpr=2&img-onerror=redirect"),[o,c]=(0,r.useState)(l);return(0,r.useEffect)(()=>{c(l)},[e]),(0,s.jsx)(s.Fragment,{children:t?(0,s.jsx)(i,{className:e.className||"",width:e.width||100,height:e.height||100,text:"Unable to display image",fontSize:"65%",background:"transparent"}):(0,s.jsx)(n.default,{...e,src:o,unoptimized:!0,onError:()=>{c(e.src),o===e.src&&a(!0)},style:{display:t?"none":"block"}})})}},17233:function(e,t,a){"use strict";a.d(t,{w:function(){return v}});var s=a(57437),n=a(90837),r=a(59324),i=a(37440),l=a(29113),o=a(54891),c=a(4867),d=a(28782),u=a(43061),f=a(66648),h=a(2265),p=a(27485),m=a(19198),x=a(6299),g=a(50495);function v(){let[e,t]=(0,u._)("show-wallet",!1),{select:a,wallets:v,publicKey:b,disconnect:w}=(0,d.O)(),{decodedJwt:y,login:j,loginLoading:N,user:k,logout:S}=(0,o.U)(),{solBalance:E}=(0,r.h)(null==b?void 0:b.toBase58()),{ipfsPrefix:T}=(0,l.y)(),_=!!(b&&!y);(0,h.useEffect)(()=>{_&&j()},[_]);let C=(0,i.Py)(null==k?void 0:k.profile_image,T),P=()=>{window.open("https://wallet.magiceden.io/download","_blank")};return(0,s.jsxs)(n.Vq,{open:e||_,onOpenChange:e=>!_&&t(e),children:[(0,s.jsx)(n.hg,{asChild:!0,children:b?(0,s.jsx)("div",{className:"text-white text-sm grid justify-items-end",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 border border-slate-500 rounded px-1 cursor-pointer hover:bg-slate-600",children:[(0,s.jsxs)("span",{className:"hidden sm:block",children:[!!E&&E&&(0,s.jsxs)(s.Fragment,{children:["(",(E/1e9).toFixed(2)," SOL)"]})," "]}),(0,s.jsx)("div",{children:(0,s.jsx)(x.default,{width:16,height:16,className:"w-4 h-4 rounded-full object-contain",src:C,alt:""})}),(0,s.jsx)("div",{children:(null==k?void 0:k.username)||b.toBase58().slice(0,6)}),(0,s.jsx)(c.AS7,{})]})}):(0,s.jsx)("button",{className:"text-sm text-slate-50 hover:font-bold hover:bg-transparent hover:text-slate-50",children:"[connect wallet]"})}),(0,s.jsx)(n.cZ,{className:"bg-primary text-white text-center",children:(0,s.jsx)(s.Fragment,{children:(()=>{if(_)return(0,s.jsxs)("div",{className:"grid gap-4 justify-items-center",children:[(0,s.jsx)("div",{children:"Sign in to Pump"}),N?(0,s.jsxs)("div",{className:"flex gap-4 py-2 px-4 border border-white rounded-full w-fit",children:[(0,s.jsx)("div",{children:"Confirm in your wallet"}),(0,s.jsx)(p.iT,{color:"white",height:24,width:24})]}):(0,s.jsx)(g.z,{className:"bg-gray-300 text-primary hover:text-slate-50",onClick:()=>j(),children:"Sign message"})]});if(!b){let e=v.filter(e=>"Installed"===e.readyState||"Loadable"===e.readyState),t=e.some(e=>"Magic Eden"===e.adapter.name),n=[...e];return t||n.splice(3,0,{adapter:{name:"Magic Eden",icon:"/magic_eden.png?height=24&width=24"}}),(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsx)("div",{children:"Connect your wallet"}),n.length>0?n.map((e,n)=>(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsxs)(g.z,{onClick:()=>"Magic Eden"!==e.adapter.name||t?a(e.adapter.name):P(),className:"relative w-[180px] bg-[#5c5f66] text-white flex items-center justify-center px-4 py-2 rounded-md",children:[(0,s.jsx)(f.default,{src:e.adapter.icon,alt:e.adapter.name,width:24,height:24,className:"absolute left-2"}),e.adapter.name]})},n)):(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)("p",{children:"No wallet found. Please download a supported Solana wallet."})})]})}return(0,s.jsxs)("div",{className:"grid gap-4 justify-center",children:[(0,s.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,s.jsx)("div",{children:(0,s.jsx)(x.default,{width:64,height:64,className:"w-16 h-16 rounded-full border border-slate-600 object-contain",src:C,alt:""})}),(0,s.jsxs)("div",{className:"grid justify-items-start gap-1",children:[(0,s.jsxs)("div",{children:["@",(null==k?void 0:k.username)||b.toBase58().slice(0,6)]}),(0,s.jsx)("div",{children:(null==k?void 0:k.bio)||""}),(0,s.jsx)(m.J,{})]})]}),(0,s.jsx)("div",{className:"text-xs sm:text-sm border border-white rounded p-2",children:b.toBase58()}),(0,s.jsx)(g.z,{className:"bg-gray-300 text-primary hover:text-slate-50",onClick:async()=>{await w(),await S()},children:"Disconnect wallet"}),(0,s.jsx)("div",{className:"text-slate-50 hover:font-bold hover:text-slate-50 cursor-pointer w-fit justify-self-center",onClick:()=>t(!1),children:"[close]"})]})})()})})]})}},50495:function(e,t,a){"use strict";a.d(t,{z:function(){return c}});var s=a(57437),n=a(2265),r=a(71538),i=a(12218),l=a(37440);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-slate-950 dark:focus-visible:ring-slate-300",{variants:{variant:{default:"bg-slate-900 text-slate-50 hover:bg-slate-900/90 dark:bg-slate-50 dark:text-slate-900 dark:hover:bg-slate-50/90",destructive:"bg-red-500 text-slate-50 hover:bg-red-500/90 dark:bg-red-900 dark:text-slate-50 dark:hover:bg-red-900/90",outline:"border border-slate-200 bg-white hover:bg-slate-100 hover:text-slate-900 dark:border-slate-800 dark:bg-slate-950 dark:hover:bg-slate-800 dark:hover:text-slate-50",secondary:"bg-slate-100 text-slate-900 hover:bg-slate-100/80 dark:bg-slate-800 dark:text-slate-50 dark:hover:bg-slate-800/80",ghost:"hover:bg-slate-100 hover:text-slate-900 dark:hover:bg-slate-800 dark:hover:text-slate-50",link:"text-slate-900 underline-offset-4 hover:underline dark:text-slate-50"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:a,variant:n,size:i,asChild:c=!1,...d}=e,u=c?r.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:n,size:i,className:a})),ref:t,...d})});c.displayName="Button"},90837:function(e,t,a){"use strict";a.d(t,{$N:function(){return p},Vq:function(){return o},cZ:function(){return f},fK:function(){return h},hg:function(){return c}});var s=a(57437),n=a(2265),r=a(13304),i=a(74697),l=a(37440);let o=r.fC,c=r.xz,d=r.h_;r.x8;let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});u.displayName=r.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:a,children:n,showClose:o,...c}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(r.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-slate-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-slate-800 dark:bg-slate-950",a),...c,children:[n,o&&(0,s.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100 data-[state=open]:text-slate-500 dark:ring-offset-slate-950 dark:focus:ring-slate-300 dark:data-[state=open]:bg-slate-800 dark:data-[state=open]:text-slate-400",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=r.VY.displayName;let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};h.displayName="DialogHeader";let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});p.displayName=r.Dx.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.dk,{ref:t,className:(0,l.cn)("text-sm text-slate-500 dark:text-slate-400",a),...n})}).displayName=r.dk.displayName},83102:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var s=a(57437),n=a(2265),r=a(37440);let i=n.forwardRef((e,t)=>{let{className:a,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:bg-slate-950 dark:ring-offset-slate-950 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",a),ref:t,...i})});i.displayName="Input"},35657:function(e,t,a){"use strict";a.d(t,{pm:function(){return x},qz:function(){return i}});var s=a(2265),n=a(45429),r=a(25566);let i=5e8,l=0,o=new Map,c=e=>{if(o.has(e))return},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,4)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?c(a):e.toasts.forEach(e=>{c(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},u=[],f={toasts:[]};function h(e){f=d(f,e),u.forEach(e=>{e(f)})}function p(e){let{...t}=e,a=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>h({type:"DISMISS_TOAST",toastId:a});return h({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>h({type:"UPDATE_TOAST",toast:{...e,id:a}})}}let m=async e=>{let{...t}=e;if(!t.signature){p({...t});return}let{update:a}=p({...t,status:"pending"}),s=["https://pump-fe.helius-rpc.com?api-key=1b8db865-a5a1-4535-9aec-01061440523b",r.env.NEXT_PUBLIC_SOLANA_API_URL2,r.env.NEXT_PUBLIC_SOLANA_API_URL3,r.env.NEXT_PUBLIC_SOLANA_API_URL5,r.env.NEXT_PUBLIC_SOLANA_API_URL6].filter(e=>e);return new Promise((e,r)=>{s.map(async s=>{let i=new n.Connection(s,"processed"),l=await i.getLatestBlockhash("finalized");i.confirmTransaction({blockhash:l.blockhash,lastValidBlockHeight:l.lastValidBlockHeight,signature:t.signature},"processed").then(s=>{s.value.err?a({...t,status:"error",id:""}):a({...t,status:"success",id:""}),e(t.signature)}).catch(e=>{console.error(t,t.signature,e),a({...t,status:"error",id:""}),r(e)}),i.confirmTransaction({blockhash:l.blockhash,lastValidBlockHeight:l.lastValidBlockHeight,signature:t.signature},"confirmed").then(s=>{s.value.err?a({...t,status:"error",id:""}):a({...t,status:"success",id:""}),e(t.signature)}).catch(e=>{console.error(t,t.signature,e),a({...t,status:"error",id:""}),r(e)})})})};function x(){let[e,t]=s.useState(f);return s.useEffect(()=>(u.push(t),()=>{let e=u.indexOf(t);e>-1&&u.splice(e,1)}),[e]),{...e,toast:p,toastTransaction:m,dismiss:e=>h({type:"DISMISS_TOAST",toastId:e})}}},59324:function(e,t,a){"use strict";a.d(t,{h:function(){return i}});var s=a(61811),n=a(45429),r=a(2265);let i=e=>{let[t,a]=(0,r.useState)(),{connection:i}=(0,s.R)();async function l(){if(e)try{let t=await i.getBalance(new n.PublicKey(e));a(t)}catch(e){console.error("Error fetching initial balance:",e)}}return(0,r.useEffect)(()=>{if(!e)return;l();let t=i.onAccountChange(new n.PublicKey(e),async e=>{a(e.lamports)},"confirmed");return()=>{i.removeAccountChangeListener(t)}},[e]),{solBalance:t,fetchSolBalance:l}}},48689:function(e,t,a){"use strict";a.d(t,{a:function(){return n}});var s=a(2265);let n=e=>{let[t,a]=(0,s.useState)(),n=async()=>{if(e)try{let t=await fetch("".concat("https://frontend-api.pump.fun","/users/").concat(e)).then(e=>null==e?void 0:e.json());a(t)}catch(e){console.log(e)}};return(0,s.useEffect)(()=>{n()},[e]),{fetchUser:n,user:t}}},37440:function(e,t,a){"use strict";a.d(t,{Py:function(){return l},WE:function(){return i},_o:function(){return c},cn:function(){return r},i$:function(){return o}});var s=a(44839),n=a(96164);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,s.W)(t))}let i="https://cf-ipfs.com/ipfs/QmeSzchzEPqCU1jwTnsipwcBAeH7S4bmVvFGfF65iA1BY1",l=(e,t)=>(e||i).replace(/https:\/\/[^/]+\/ipfs\//,t);function o(e,t){let a=new Date(e);return new Intl.DateTimeFormat("en-GB",t||{dateStyle:"short",timeStyle:"short"}).format(a)}function c(){let e=Date.now();return{soft:e+144e5,normal:e+432e6,perma:e+864e9}}},29113:function(e,t,a){"use strict";a.d(t,{IpfsPrefixProvider:function(){return c},y:function(){return l}});var s=a(57437),n=a(2265),r=a(25566);let i=(0,n.createContext)({ipfsPrefix:"https://ipfs.io/ipfs/",findIpfsPrefix:()=>{}}),l=()=>(0,n.useContext)(i),o=r.env.NEXT_PUBLIC_IPFS_PROVIDER||"https://pump.mypinata.cloud/ipfs/",c=e=>{let{children:t}=e,[a,r]=(0,n.useState)(o),l=async()=>{let e="QmXeG5tTjC63hjTF7a4GcUyetE6yPcsR4rBzX7wb8mmpzg",t=["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/"];await fetch("".concat(o).concat(e)).then(e=>e.json()).then(e=>{r(o)}).catch(a=>{console.error(a),t.forEach(async t=>{let a=await fetch("".concat(t).concat(e)).then(e=>e.json());(null==a?void 0:a.name)&&r(e=>e!==o?e:t)})})};return(0,n.useEffect)(()=>{l()},[]),(0,s.jsx)(i.Provider,{value:{ipfsPrefix:a,findIpfsPrefix:l},children:t})}},54891:function(e,t,a){"use strict";a.d(t,{ProfileProvider:function(){return m},U:function(){return p}});var s=a(57437),n=a(48689),r=a(65916),i=a(9881),l=a(28782),o=a(4815),c=a(46124),d=a.n(c),u=a(2265),f=a(70750);let h=(0,u.createContext)({}),p=()=>(0,u.useContext)(h),m=e=>{let{children:t}=e,[a,c]=(0,u.useState)(!1),{signMessage:p,publicKey:m}=(0,l.O)(),[x,g]=(0,o._)("decoded-jwt",null),[v,b]=(0,f._)("last-sort-update",0),w=null==x?void 0:x.address,{user:y,fetchUser:j}=(0,n.a)(w),[N,k]=(0,u.useState)(!1),S=async()=>{await fetch("".concat("https://frontend-api.pump.fun","/auth/logout"),{method:"POST",credentials:"include"}).then(e=>e.json()),g(null),b(0)},E=async()=>{try{let e=await fetch("".concat("https://frontend-api.pump.fun","/era"),{method:"GET"});if(!e.ok)return console.error("getEra: ".concat(e.status)),null;return await e.text()}catch(e){return console.error("getEra:",e),null}},T=async e=>{if(void 0!==e&&x&&(null===x.era||x.era!==e)){S();return}try{let e=await fetch("".concat("https://frontend-api.pump.fun","/auth/my-profile"),{method:"GET",credentials:"include"});if(!e.ok){b(0),g(null);return}let t=await e.json();JSON.stringify(x)!==JSON.stringify(t)&&g(t)}catch(e){console.error(e),b(0),g(null)}},_=async()=>{if(!p||!m)throw Error("Wallet not connected");c(!0);try{let e=Date.now(),t=d().encode(await p(new TextEncoder().encode("Sign in to pump.fun: ".concat(e))));await fetch("".concat("https://frontend-api.pump.fun","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({address:m.toBase58(),signature:t,timestamp:e})}).then(e=>e.json()),await T()}catch(e){console.error("Failed to login",e)}finally{c(!1)}};return(0,u.useEffect)(()=>{(async()=>{T(await E())})()},[]),(0,u.useEffect)(()=>{let e=()=>{let e=(0,r.dk)();return e&&k(!0),e};e();let t=setInterval(()=>{e()&&clearInterval(t)},2e3);return()=>clearInterval(t)},[]),(0,u.useEffect)(()=>{w&&((0,i.sendGTMEvent)({user_id:w}),N&&(0,r.u8)("setIdentity",{uid:w}))},[w,N]),(0,u.useEffect)(()=>{if(x){if(1e3*x.exp<Date.now()||m&&m.toBase58()!==x.address){b(0),g(null);return}fetch("".concat("https://frontend-api.pump.fun","/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({address:x.address})})}},[x,m]),(0,s.jsx)(h.Provider,{value:{decodedJwt:x,login:_,loginLoading:a,address:w,user:y,roles:null==x?void 0:x.roles,fetchUser:j,logout:S},children:t})}}}]);